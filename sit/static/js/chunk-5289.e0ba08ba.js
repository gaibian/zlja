(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5289","chunk-0a31"],{"0hYm":function(e,t,n){"use strict";n.r(t);var a=n("pCtG"),l=n("t3Un"),i=n("kFDl"),o=n("FRzO"),r=n("jr1U"),s=n.n(r),u=n("rfXi"),c=n.n(u),d=n("Kw5r");function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=[];return c()(e).forEach(function(e){void 0===e._expanded&&d.default.set(e,"_expanded",t);var i=1;if(void 0!==a&&null!==a&&(i=a+1),d.default.set(e,"_level",i),n&&d.default.set(e,"parent",n),l.push(e),e.children&&e.children.length>0){var o=f(e.children,t,e,i);l=l.concat(o)}}),l}var m={name:"treeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},created:function(){},computed:{formatData:function(){var e=void 0;e=Array.isArray(this.data)?this.data:[this.data];var t=this.evalFunc||f,n=this.evalArgs?s()([e,this.expandAll],this.evalArgs):[e,this.expandAll];return t.apply(null,n)}},methods:{showRow:function(e){var t=!e.row.parent||e.row.parent._expanded&&e.row.parent._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},handleSelectionChange:function(e){this.$emit("selectVal",e)},toggleExpanded:function(e){var t=this.formatData[e];t._expanded=!t._expanded},iconShow:function(e,t){return 0===e&&t.children&&t.children.length>0}}},p=(n("0wzR"),n("zIXf"),n("KHd+")),h=Object(p.a)(m,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._b({attrs:{data:e.formatData,"row-style":e.showRow},on:{"selection-change":e.handleSelectionChange}},"el-table",e.$attrs,!1),[n("el-table-column",{attrs:{type:"selection",context:e._self,width:"50"}}),e._v(" "),0===e.columns.length?n("el-table-column",{attrs:{label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row._level,function(e){return n("span",{key:e,staticClass:"ms-tree-space"})}),e._v(" "),e.iconShow(0,t.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(n){e.toggleExpanded(t.$index)}}},[t.row._expanded?n("i",{staticClass:"el-icon-caret-bottom"}):n("i",{staticClass:"el-icon-caret-right"})]):e._e(),e._v("\n      "+e._s(t.row.title)+"\n    ")]}}])}):e._l(e.columns,function(t,a){return n("el-table-column",{key:t.value,attrs:{label:t.text,width:t.width},scopedSlots:e._u([{key:"default",fn:function(l){return[e._l(l.row._level,function(t){return 0===a?n("span",{key:t,staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.iconShow(a,l.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(l.$index)}}},[l.row._expanded?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n      "+e._s(l.row[t.value])+"\n    ")]}}])})}),e._v(" "),e._t("default")],2)},[],!1,null,"4af09f7e",null);h.options.__file="index.vue";var g=h.exports;function _(e,t,n,a,l){var i=[],o=[];return c()(e).forEach(function(e){void 0===e._expanded&&d.default.set(e,"_expanded",t);var r=1;if(void 0!==a&&null!==a&&(r=a+1),d.default.set(e,"_level",r),n?(d.default.set(e,"parent",n),i[r]||(i[r]=0),d.default.set(e,"_marginLeft",i[r]+n._marginLeft),d.default.set(e,"_width",e[l]/n[l]*n._width),i[r]+=e._width):(i[e.id]=[],i[e.id][r]=0,d.default.set(e,"_marginLeft",0),d.default.set(e,"_width",1)),o.push(e),e.children&&e.children.length>0){var s=_(e.children,t,e,r,l);o=o.concat(s)}}),o}var v={name:"menuList",mixins:[a.a],components:{menuEdit:o.default,treeTable:g},data:function(){return{func:_,args:[null,null,"timeLine"],tableData:[],multipleSelection:[],loading:!0,expandAll:!1,centerDialogVisible:!1,tableHeight:null,rule:null}},methods:{init:function(){var e=this;this.loading=!0,l.a.get("admin/menus").then(function(t){e.tableData=t.data,e.loading=!e.loading})},getSelectVal:function(e){this.multipleSelection=e},dialogClose:function(){this.init(),this.centerDialogVisible=!1},handleClose:function(){this.centerDialogVisible=!1,this.$refs.dialog.close()},clickEdit:function(e){this.editId=e.id,this.centerDialogVisible=!0,this.$refs.dialog.open()},selectItem:function(e){this.multipleSelection=e},confirmDelete:function(e){var t=this;this.$confirm("确认删除该菜单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.c)(e.id).then(function(e){_g.toastMsg("success","删除成功"),setTimeout(function(){t.refresh()},1500)})}).catch(function(){})}},created:function(){this.init(),this.rule={deletesShow:this.deletesShow,enablesShow:this.enablesShow}},computed:{indexShow:function(){return _g.getHasRule("admin-menus-index")},addShow:function(){return _g.getHasRule("admin-menus-save")},readShow:function(){return _g.getHasRule("admin-menus-read")},deletesShow:function(){return _g.getHasRule("admin-menus-deletes")},enablesShow:function(){return _g.getHasRule("admin-menus-enables")},deleteShow:function(){return _g.getHasRule("admin-menus-delete")}}},b=(n("o6pO"),Object(p.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"mainContainer",staticClass:"app_main_container"},[n("div",{ref:"topAdd",staticClass:"top_add_menu_container"},[n("router-link",{staticClass:"btn-link-large add-btn",attrs:{to:"add"}},[e.addShow?n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"}},[e._v("添加菜单")]):e._e()],1)],1),e._v(" "),e.indexShow?n("div",{staticClass:"page_table_box"},[n("tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"element-loading-text":"数据加载中",evalFunc:e.func,evalArgs:e.args,expandAll:e.expandAll,"max-height":e.tableHeight,border:""},on:{selectVal:e.getSelectVal}},[n("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("el-tag",{attrs:{type:1===t.row.status?"":"warning"}},[e._v("\n              "+e._s(e._f("status")(t.row.status))+"\n            ")])],1)]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"185"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e.readShow?n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){e.clickEdit(t.row)}}},[n("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"operate-edit"}}),e._v("编辑")],1):e._e(),e._v(" "),e.deleteShow?n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){e.confirmDelete(t.row)}}},[n("svg-icon",{staticStyle:{"margin-right":"6px"},attrs:{"icon-class":"operate-delete"}}),e._v("删除")],1):e._e()],1)]}}])})],1),e._v(" "),n("div",{ref:"btmGroup",staticClass:"pos-rel p-t-20",staticStyle:{height:"70px"},attrs:{type:"flex",align:"middle"}},[n("el-row",{staticStyle:{height:"100%"},attrs:{type:"flex",align:"middle",justify:"space-between"}},[n("btnGroup",{attrs:{selectedData:e.multipleSelection,type:"admin/menus",rule:e.rule},on:{change:e.refresh}})],1)],1)],1):e._e(),e._v(" "),n("el-dialog",{ref:"dialog",staticClass:"dialog-slider",attrs:{top:"0",width:"400px","lock-scroll":"",visible:e.centerDialogVisible,"before-close":e.handleClose,title:"菜单编辑"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[e.centerDialogVisible?n("menu-edit",{attrs:{editId:e.editId},on:{close:e.dialogClose}}):e._e()],1)],1)},[],!1,null,"266e7798",null));b.options.__file="list.vue";t.default=b.exports},"0wzR":function(e,t,n){"use strict";var a=n("EnZY");n.n(a).a},"1Tpe":function(e,t,n){"use strict";var a=n("TK5H");n.n(a).a},"9F6i":function(e,t,n){"use strict";var a=n("kFDl"),l=n("jr1U"),i=n.n(l),o=n("rfXi"),r=n.n(o),s=n("Kw5r");function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=[];return r()(e).forEach(function(e){void 0===e._expanded&&s.default.set(e,"_expanded",t);var i=1;if(void 0!==a&&null!==a&&(i=a+1),s.default.set(e,"_level",i),n&&s.default.set(e,"parent",n),l.push(e),e.children&&e.children.length>0){var o=u(e.children,t,e,i);l=l.concat(o)}}),l}var c={name:"treeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},created:function(){},computed:{formatData:function(){var e=void 0;e=Array.isArray(this.data)?this.data:[this.data];var t=this.evalFunc||u,n=this.evalArgs?i()([e,this.expandAll],this.evalArgs):[e,this.expandAll];return t.apply(null,n)}},methods:{showRow:function(e){var t=!e.row.parent||e.row.parent._expanded&&e.row.parent._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},handleSelectionChange:function(e){this.$emit("selectVal",e)},toggleExpanded:function(e){var t=this.formatData[e];t._expanded=!t._expanded},iconShow:function(e,t){return 0===e&&t.children&&t.children.length>0}}},d=(n("Vfc6"),n("rtKK"),n("KHd+")),f=Object(d.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._b({attrs:{data:e.formatData,"row-style":e.showRow},on:{"selection-change":e.handleSelectionChange}},"el-table",e.$attrs,!1),[0===e.columns.length?n("el-table-column",{attrs:{label:"显示名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row._level,function(e){return n("span",{key:e,staticClass:"ms-tree-space"})}),e._v(" "),e.iconShow(0,t.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(n){e.toggleExpanded(t.$index)}}},[t.row._expanded?n("i",{staticClass:"el-icon-caret-bottom"}):n("i",{staticClass:"el-icon-caret-right"})]):e._e(),e._v("\n      "+e._s(t.row.title)+"\n    ")]}}])}):e._l(e.columns,function(t,a){return n("el-table-column",{key:t.value,attrs:{label:t.text,width:t.width},scopedSlots:e._u([{key:"default",fn:function(l){return[e._l(l.row._level,function(t){return 0===a?n("span",{key:t,staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.iconShow(a,l.row)?n("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(l.$index)}}},[l.row._expanded?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n      "+e._s(l.row[t.value])+"\n    ")]}}])})}),e._v(" "),e._t("default")],2)},[],!1,null,"4e78801c",null);function m(e,t,n,a,l){var i=[],o=[];return r()(e).forEach(function(e){void 0===e._expanded&&s.default.set(e,"_expanded",t);var r=1;if(void 0!==a&&null!==a&&(r=a+1),s.default.set(e,"_level",r),n?(s.default.set(e,"parent",n),i[r]||(i[r]=0),s.default.set(e,"_marginLeft",i[r]+n._marginLeft),s.default.set(e,"_width",e[l]/n[l]*n._width),i[r]+=e._width):(i[e.id]=[],i[e.id][r]=0,s.default.set(e,"_marginLeft",0),s.default.set(e,"_width",1)),o.push(e),e.children&&e.children.length>0){var u=m(e.children,t,e,r,l);o=o.concat(u)}}),o}f.options.__file="index.vue";var p={props:["flag"],components:{treeTable:f.exports},data:function(){return{func:m,args:[null,null,"timeLine"],keyword:"",tableData:[],newFlag:!1,expandAll:!1,loading:!0,tableHeight:null,multipleSelection:[]}},methods:{getSelectVal:function(e){this.multipleSelection=e},selectRule:function(e){var t={rule_name:e.title,rule_id:e.id};this.$emit("closeRule",t)},getRules:function(){var e=this;Object(a.e)().then(function(t){e.tableDataShow=_(t.data).forEach(function(e){e.showInput=!1}),e.tableData=e.tableDataShow,e.loading=!e.loading})}},created:function(){var e=store.state.rules;e&&e.length?(this.tableDataShow=_(e).forEach(function(e){e.showInput=!1}),this.tableData=this.tableDataShow):(console.log("aaa"),this.getRules()),console.log(e)}},h=(n("1Tpe"),Object(d.a)(p,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("dialog-scroll",{attrs:{height:"500px"}},[n("div",{staticStyle:{"padding-bottom":"20px"}},[n("tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,evalFunc:e.func,evalArgs:e.args,"element-loading-text":"数据加载中",expandAll:e.expandAll,"max-height":e.tableHeight,border:""},on:{selectVal:e.getSelectVal}},[n("el-table-column",{attrs:{prop:"title",label:"规则名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"规则标识",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("el-button",{attrs:{size:"small"},on:{click:function(n){e.selectRule(t.row)}}},[e._v("选择")])],1)]}}])})],1)],1)])},[],!1,null,"5c8d9a5a",null));h.options.__file="rule.vue";t.a=h.exports},EnZY:function(e,t,n){},FRzO:function(e,t,n){"use strict";n.r(t);var a=n("XINx"),l=n("9F6i"),i=n("kFDl"),o={components:{ruleList:l.a},directives:{elDragDialog:a.a},props:["editId"],data:function(){return{loading:!1,id:null,centerDialogVisible:!1,isLoading:!1,formLoading:!1,form:{title:"",rule_name:"",rule_id:null,pid:"",menu_type:"",url:"",module:"",menu:"",sort:""},options:[{id:0,title:"无"}],rules:{title:[{required:!0,message:"请输入菜单标题"}],rule_name:[{required:!0,message:"请绑定权限标识"}],menu_type:[{required:!0,message:"请选择菜单类型"}],module:[{required:!0,message:"请填写菜单模块"}],pid:[{type:"number",required:!0,message:"请选择上级菜单"}]}}},methods:{handleClose:function(){this.centerDialogVisible=!1,this.$refs.dialog.close()},dialogClose:function(e){this.centerDialogVisible=!1,this.form.rule_name=e.rule_name,this.form.rule_id=e.rule_id},edit:function(e){var t=this;this.$refs.form.validate(function(e){e&&(t.isLoading=!t.isLoading,Object(i.f)(t.id,t.form).then(function(e){_g.toastMsg("success","编辑成功"),setTimeout(function(){t.$emit("close"),t.isLoading=!t.isLoading},1500)}))})},openRule:function(){this.centerDialogVisible=!0,this.$refs.dialog.open()},goback:function(){router.go(-1)},getMenus:function(){var e=this;Object(i.d)().then(function(t){var n=[];_(t.data).forEach(function(e){3!=e.level&&1==e.menu_type&&n.push(e)}),e.options=e.options.concat(n)})}},created:function(){var e=this;this.formLoading=!0,this.getMenus(),this.id=this.editId,Object(i.b)(this.id).then(function(t){t.data.menu_type=t.data.menu_type.toString(),e.form=t.data,e.formLoading=!1})},computed:{editShow:function(){return _g.getHasRule("admin-menus-update")}}},r=n("KHd+"),s=Object(r.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("dialog-scroll",{attrs:{formLoading:e.formLoading}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"110px","label-position":"top"}},[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{attrs:{clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"==typeof t?t.trim():t)},expression:"form.title"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"绑定权限标识",prop:"rule_name"}},[n("el-input",{attrs:{clearable:"",disabled:!0},model:{value:e.form.rule_name,callback:function(t){e.$set(e.form,"rule_name","string"==typeof t?t.trim():t)},expression:"form.rule_name"}},[n("el-button",{attrs:{slot:"append"},on:{click:function(t){e.openRule()}},slot:"append"},[e._v("查找")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"菜单类型",prop:"menu_type"}},[n("el-radio-group",{model:{value:e.form.menu_type,callback:function(t){e.$set(e.form,"menu_type",t)},expression:"form.menu_type"}},[n("el-radio",{attrs:{disabled:"",label:"1"}},[e._v("普通三级菜单")]),e._v(" "),n("el-radio",{attrs:{disabled:"",label:"2"}},[e._v("单页菜单")]),e._v(" "),n("el-radio",{attrs:{disabled:"",label:"3"}},[e._v("外链")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"上级菜单",prop:"pid"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择活动区域"},model:{value:e.form.pid,callback:function(t){e.$set(e.form,"pid",t)},expression:"form.pid"}},e._l(e.options,function(e,t){return n("el-option",{key:t,attrs:{label:e.title,value:e.id}})}))],1),e._v(" "),n("el-form-item",{attrs:{label:"路径"}},[n("el-input",{attrs:{clearable:""},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url","string"==typeof t?t.trim():t)},expression:"form.url"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"模块",prop:"module"}},[n("el-input",{attrs:{clearable:""},model:{value:e.form.module,callback:function(t){e.$set(e.form,"module","string"==typeof t?t.trim():t)},expression:"form.module"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"所属菜单"}},[n("el-input",{attrs:{clearable:""},model:{value:e.form.menu,callback:function(t){e.$set(e.form,"menu","string"==typeof t?t.trim():t)},expression:"form.menu"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"排序"}},[n("el-input",{attrs:{clearable:""},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),n("el-form-item",[e.editShow?n("el-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:function(t){e.edit("form")}}},[e._v("提交")]):e._e()],1)],1),e._v(" "),n("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],ref:"dialog",attrs:{width:"800px","append-to-body":"",visible:e.centerDialogVisible,"before-close":e.handleClose,title:"绑定权限标识"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[e.centerDialogVisible?n("ruleList",{ref:"ruleList",on:{closeRule:e.dialogClose}}):e._e()],1)],1)},[],!1,null,null,null);s.options.__file="edit.vue";t.default=s.exports},KlOs:function(e,t,n){},Sd6z:function(e,t,n){},"SdK+":function(e,t,n){},TK5H:function(e,t,n){},Vfc6:function(e,t,n){"use strict";var a=n("bXlL");n.n(a).a},bXlL:function(e,t,n){},jr1U:function(e,t,n){e.exports={default:n("wObO"),__esModule:!0}},kFDl:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return r}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return u});var a=n("t3Un");function l(){return a.a.get("admin/menus")}function i(e){return a.a.delete("admin/menus/",e)}function o(e){return a.a.get("admin/menus/"+e)}function r(e){return a.a.post("admin/menus",e)}function s(e,t){return a.a.put("admin/menus/",e,t)}function u(){return a.a.get("admin/rules")}},o6pO:function(e,t,n){"use strict";var a=n("KlOs");n.n(a).a},pCtG:function(e,t,n){"use strict";var a=n("7Qib");t.a={mounted:function(){var e=this;this.valHandle(),this.__resizeMainHanlder=Object(a.a)(function(){e.valHandle(0,0)},100),window.addEventListener("resize",this.__resizeMainHanlder)},methods:{valHandle:function(e,t){var n=this.$refs.mainContainer.offsetHeight-40-((this.$refs.topAdd?this.$refs.topAdd.offsetHeight:0)+(this.$refs.btmGroup?this.$refs.btmGroup.offsetHeight:20));this.tableHeight=n}},beforeDestroy:function(){window.removeEventListener("resize",this.__resizeMainHanlder)}}},rtKK:function(e,t,n){"use strict";var a=n("SdK+");n.n(a).a},wObO:function(e,t){e.exports=function(){return Function.call.apply(Array.prototype.concat,arguments)}},zIXf:function(e,t,n){"use strict";var a=n("Sd6z");n.n(a).a}}]);