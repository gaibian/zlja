(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1331"],{"8T0q":function(t,e,a){"use strict";a.d(e,"r",function(){return i}),a.d(e,"a",function(){return o}),a.d(e,"f",function(){return l}),a.d(e,"g",function(){return r}),a.d(e,"h",function(){return s}),a.d(e,"b",function(){return c}),a.d(e,"d",function(){return u}),a.d(e,"e",function(){return m}),a.d(e,"c",function(){return d}),a.d(e,"i",function(){return _}),a.d(e,"j",function(){return p}),a.d(e,"k",function(){return f}),a.d(e,"l",function(){return v}),a.d(e,"q",function(){return b}),a.d(e,"m",function(){return h}),a.d(e,"n",function(){return y}),a.d(e,"o",function(){return k}),a.d(e,"p",function(){return g});var n=a("t3Un");function i(t){return n.a.get("insurance/company",t)}function o(t){return n.a.post("insurance/company",t)}function l(t){return n.a.delete("insurance/company/"+t)}function r(t){return n.a.get("insurance/company/"+t)}function s(t,e){return n.a.put("insurance/company/",t,e)}function c(t){return n.a.post("insurance/companyRate",t)}function u(t){return n.a.get("insurance/companyRate/"+t)}function m(t,e){return n.a.put("insurance/companyRate/",t,e)}function d(t){return n.a.delete("insurance/companyRate/"+t)}function _(t){return n.a.post("insurance/ask",t)}function p(t){return n.a.delete("insurance/ask/"+t)}function f(t){return n.a.get("insurance/ask/"+t)}function v(t,e){return n.a.put("insurance/ask/",t,e)}function b(t){return n.a.get("insurance/ask/logIndex",t)}function h(t){return n.a.post("insurance/ask/logSave",t)}function y(t){return n.a.delete("insurance/ask/logDelete/?id="+t,"")}function k(t){return n.a.get("insurance/ask/logRead/?id="+t)}function g(t,e){return n.a.put("insurance/ask/logUpdate/",t,e)}},Ihu9:function(t,e,a){"use strict";a.r(e);var n=a("gDS+"),i=a.n(n),o=a("P2sY"),l=a.n(o),r=(a("8T0q"),a("iz2W")),s={name:"noCarCirculationadd",filters:{decimal:function(t){return t.toFixed(2)}},data:function(){return{isLoading:!1,detailFlag:!1,isPlusActive:!1,isReduceActive:!1,form:{write_date:"",salesman:"",insured_name:"",card_number:"",kind:"",company_id:"",remark:"",main_policy_number:"",main_tax:0,main_premium:0,additional_tax:0,additional_premium:0,additional_policy_number:"",total_rate:"",commission_rate:"",total_rate_deal_type:"",company_name:"",commission_rate_deal_type:"",policy_number:"",details:[{type:0,kind_name:"",main_tax:"",main_premium:0,main_policy_num:0,main_addNum:0}]},companyData:{type:1,id:"",company_name:""},xzOptions:[{label:"主险",id:0},{label:"附加险",id:1}],typeOptions:[{label:"全保费",id:1},{label:"净保费",id:2}],userData:{type:1}}},computed:{total_rate_num:function(){if(1==this.form.total_rate_deal_type){var t=0;return _(this.form.details).forEach(function(e){t+=e.main_premium}),(t*(this.form.total_rate/100)).toFixed(2)}if(2==this.form.total_rate_deal_type){var e=0;return _(this.form.details).forEach(function(t){e+=Number(t.main_policy_num)}),(e*(this.form.total_rate/100)).toFixed(2)}return 0},commission_rate_num:function(){if(1==this.form.commission_rate_deal_type){var t=0;return _(this.form.details).forEach(function(e){t+=e.main_premium}),(t*this.form.commission_rate/100).toFixed(2)}if(2==this.form.commission_rate_deal_type){var e=0;return _(this.form.details).forEach(function(t){e+=Number(t.main_policy_num)}),(e*this.form.commission_rate/100).toFixed(2)}return 0}},created:function(){this.form.write_date=(new Date).format("yyyy-MM-dd")},methods:{handleEnter:function(t){"reduce"==t&&(this.isReduceActive=!0,this.isPlusActive=!1),"plus"==t&&(this.isReduceActive=!1,this.isPlusActive=!0)},handleLeave:function(t){"reduce"==t&&(this.isReduceActive=!1),"plus"==t&&(this.isPlusActive=!1)},handleBe:function(t){return t.row.main_policy_num=(t.row.main_premium/(t.row.main_tax/100+1)).toFixed(2),t.row.main_policy_num},handleZZ:function(t){return t.row.main_addNum=(t.row.main_premium-t.row.main_premium/(t.row.main_tax/100+1)).toFixed(2),t.row.main_addNum},handleDelete:function(t){if(console.log(t),1==this.form.details.length)return _g.toastMsg("error","至少保留一条险种"),!1;this.form.details.splice(t.$index,1)},handleAdd:function(t){this.form.details.splice(t.$index+1,0,{type:0,kind_name:"",main_tax:"",main_premium:0,main_policy_num:0,main_addNum:0})},handleRadio:function(t){console.log(t),this.detailFlag=1==t},handleChange:function(t){this.form.company_name=t.company_name},handleEmpty:function(){this.form={write_date:"",salesman:"",insured_name:"",card_number:"",kind:"",company_id:"",remark:"",main_policy_number:"",additional_tax:0,additional_premium:0,additional_policy_number:"",total_rate:"",commission_rate:"",total_rate_deal_type:"",company_name:"",commission_rate_deal_type:"",policy_number:""}},handleSubmit:function(){var t=this;this.isLoading=!0;var e=l()({},this.form);e.details=i()(e.details),Object(r.a)(e).then(function(e){"error"!==e?(_g.toastMsg("success","添加成功"),setTimeout(function(){t.addRefresh("noCarCirculationAdmin")},1500),t.isLoading=!1):t.isLoading=!1})}}},c=(a("asdw"),a("KHd+")),u=Object(c.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("sticky",{attrs:{className:"sub-navbar",stickyTop:84}},[a("div",{ref:"appMainFixed",staticClass:"app-main-btm-fixed"},[a("h1",{staticClass:"page-title-box"},[t._v("\n                非车流转单添加\n            ")]),t._v(" "),a("div",[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-close"},on:{click:function(e){t.handleEmpty()}}},[t._v("清空表单")]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"mini",loading:t.isLoading},on:{click:t.handleSubmit}},[t._v("保存")])],1)])]),t._v(" "),a("div",{staticClass:"app_main_content"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-position":"top"}},[a("div",{staticClass:"block-box"},[a("h1",{staticClass:"block-header-box"},[a("i"),t._v("\n                    保单信息\n                ")]),t._v(" "),a("div",{staticClass:"block-content-box"},[a("el-row",{attrs:{gutter:30}},[a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"出单日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",clearable:"",placeholder:"选择出单日期"},model:{value:t.form.write_date,callback:function(e){t.$set(t.form,"write_date",e)},expression:"form.write_date"}})],1)],1),t._v(" "),a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"业务员"}},[a("user-input",{attrs:{url:"admin/users",data:t.userData,placeholder:"请输入业务员"},model:{value:t.form.salesman,callback:function(e){t.$set(t.form,"salesman",e)},expression:"form.salesman"}})],1)],1),t._v(" "),a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"被保人"}},[a("el-input",{attrs:{placeholder:"请输入被保人"},model:{value:t.form.insured_name,callback:function(e){t.$set(t.form,"insured_name",e)},expression:"form.insured_name"}})],1)],1),t._v(" "),a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"组织架构代码证/身份证"}},[a("el-input",{attrs:{placeholder:"请输入组织架构代码证/身份证"},model:{value:t.form.card_number,callback:function(e){t.$set(t.form,"card_number",e)},expression:"form.card_number"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"投保险种"}},[a("el-input",{attrs:{placeholder:"请输入投保险种"},model:{value:t.form.kind,callback:function(e){t.$set(t.form,"kind",e)},expression:"form.kind"}})],1)],1),t._v(" "),a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"承保公司"}},[a("company-input",{attrs:{url:"insurance/company",data:t.companyData,placeholder:"请输入承保公司"},on:{change:t.handleChange},model:{value:t.form.company_id,callback:function(e){t.$set(t.form,"company_id",e)},expression:"form.company_id"}})],1)],1),t._v(" "),a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"保单号"}},[a("el-input",{attrs:{placeholder:"请输入保单号"},model:{value:t.form.policy_number,callback:function(e){t.$set(t.form,"policy_number",e)},expression:"form.policy_number"}})],1)],1),t._v(" "),a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"备注信息"}},[a("el-input",{attrs:{placeholder:"请输入备注信息"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1)],1)]),t._v(" "),a("div",{staticClass:"block-box"},[a("h1",{staticClass:"block-header-box"},[a("i"),t._v("\n                    费率计算\n                ")]),t._v(" "),a("div",{staticClass:"block-content-box"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-table",{attrs:{data:t.form.details,border:"","show-summary":""}},[a("el-table-column",{attrs:{label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{model:{value:e.row.type,callback:function(a){t.$set(e.row,"type",a)},expression:"scope.row.type"}},t._l(t.xzOptions,function(t){return a("el-option",{key:t.index,attrs:{label:t.label,value:t.id}})}))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"险种"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{placeholder:"请输入险种名称"},model:{value:e.row.kind_name,callback:function(a){t.$set(e.row,"kind_name",a)},expression:"scope.row.kind_name"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"税率(%)"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{placeholder:"请输入税率比"},model:{value:e.row.main_tax,callback:function(a){t.$set(e.row,"main_tax",t._n(a))},expression:"scope.row.main_tax"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"保费",prop:"main_premium"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{placeholder:"请输入保费金额"},model:{value:e.row.main_premium,callback:function(a){t.$set(e.row,"main_premium",t._n(a))},expression:"scope.row.main_premium"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"净保额",prop:"main_policy_num"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{value:t.handleBe(e),disabled:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"增值税额",prop:"main_addNum"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{value:t.handleZZ(e),disabled:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[a("svg-icon",{staticClass:"svg-btn",class:t.isPlusActive?"svgActive":"",attrs:{"icon-class":"plus"},nativeOn:{mouseenter:function(e){t.handleEnter("plus")},mouseleave:function(e){t.handleLeave("plus")},click:function(a){t.handleAdd(e)}}})],1),t._v(" "),a("span",{staticStyle:{"margin-left":"4px"}},[a("svg-icon",{staticClass:"svg-btn",class:t.isReduceActive?"svgActive":"",attrs:{"icon-class":"reduce"},nativeOn:{mouseenter:function(e){t.handleEnter("reduce")},mouseleave:function(e){t.handleLeave("reduce")},click:function(a){t.handleDelete(e)}}})],1)]}}])})],1)],1),t._v(" "),a("div",{staticClass:"calc-content"},[a("el-row",{staticStyle:{"border-bottom":"#EBEEF5 1px solid"},attrs:{gutter:30}},[a("el-col",{staticClass:"align-item",attrs:{span:4}},[t._v("结算")]),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[t._v("结算类型")]),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[t._v("费率(%)")]),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[t._v("金额")])],1),t._v(" "),a("el-row",{staticStyle:{"border-bottom":"#EBEEF5 1px solid"},attrs:{gutter:30}},[a("el-col",{staticClass:"align-item",attrs:{span:4}},[t._v("保险公司")]),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[a("el-select",{attrs:{placeholder:"请选择结算类型"},model:{value:t.form.total_rate_deal_type,callback:function(e){t.$set(t.form,"total_rate_deal_type",e)},expression:"form.total_rate_deal_type"}},t._l(t.typeOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}))],1),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入费率"},model:{value:t.form.total_rate,callback:function(e){t.$set(t.form,"total_rate",t._n(e))},expression:"form.total_rate"}})],1),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[a("el-input",{attrs:{disabled:""},model:{value:t.total_rate_num,callback:function(e){t.total_rate_num=e},expression:"total_rate_num"}})],1)],1),t._v(" "),a("el-row",{attrs:{gutter:30}},[a("el-col",{staticClass:"align-item",attrs:{span:4}},[t._v("业务员")]),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[a("el-select",{attrs:{placeholder:"请选择结算类型"},model:{value:t.form.commission_rate_deal_type,callback:function(e){t.$set(t.form,"commission_rate_deal_type",e)},expression:"form.commission_rate_deal_type"}},t._l(t.typeOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})}))],1),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入费率"},model:{value:t.form.commission_rate,callback:function(e){t.$set(t.form,"commission_rate",t._n(e))},expression:"form.commission_rate"}})],1),t._v(" "),a("el-col",{staticClass:"align-item",attrs:{span:4}},[a("el-input",{attrs:{disabled:""},model:{value:t.commission_rate_num,callback:function(e){t.commission_rate_num=e},expression:"commission_rate_num"}})],1)],1)],1)])]),t._v(" "),a("div",{staticClass:"block-box"},[a("h1",{staticClass:"block-header-box"},[a("i"),t._v("\n                    保单信息\n                ")]),t._v(" "),a("div",{staticClass:"block-content-box"},[a("el-row",{attrs:{gutter:30}},[a("el-col",{staticClass:"col-item",attrs:{span:6}},[a("el-form-item",{attrs:{label:"是否欠资料"}},[a("el-radio-group",{on:{change:t.handleRadio},model:{value:t.form.less_information,callback:function(e){t.$set(t.form,"less_information",e)},expression:"form.less_information"}},[a("el-radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"0"}},[t._v("否")])],1)],1)],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.detailFlag,expression:"detailFlag"}],staticClass:"col-item2",attrs:{span:12}},[a("el-form-item",{attrs:{label:"欠资料详情"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入欠资料详情"},model:{value:t.form.less_information_detail,callback:function(e){t.$set(t.form,"less_information_detail",e)},expression:"form.less_information_detail"}})],1)],1)],1)],1)])])],1)],1)},[],!1,null,"48e145fc",null);u.options.__file="add.vue";e.default=u.exports},asdw:function(t,e,a){"use strict";var n=a("jBuR");a.n(n).a},iz2W:function(t,e,a){"use strict";a.d(e,"d",function(){return i}),a.d(e,"a",function(){return o}),a.d(e,"b",function(){return l}),a.d(e,"c",function(){return r});var n=a("t3Un");function i(t){return n.a.delete("admin/noncarCirculationSheet/"+t)}function o(t){return n.a.post("admin/noncarCirculationSheet",t)}function l(t){return n.a.get("admin/noncarCirculationSheet/"+t)}function r(t,e){return n.a.put("admin/noncarCirculationSheet/",t,e)}},jBuR:function(t,e,a){}}]);