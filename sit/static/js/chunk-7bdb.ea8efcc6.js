(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7bdb"],{"1Tpe":function(e,t,l){"use strict";var n=l("TK5H");l.n(n).a},"7Gt7":function(e,t,l){"use strict";l.r(t);var n=l("XINx"),a=l("9F6i"),i=l("kFDl"),o={name:"menuAdd",components:{ruleList:a.a},directives:{elDragDialog:n.a},data:function(){return{postForm:{status:"draft"},isLoading:!1,centerDialogVisible:!1,form:{title:"",rule_name:"",rule_id:null,pid:"",menu_type:"",url:"",module:"",menu:"",sort:""},treeVal:"请选择上级菜单",defaultProps:{children:"children",label:"title"},options:[{id:0,title:"无"}],rules:{title:[{required:!0,message:"请输入菜单标题"}],menu_type:[{required:!0,message:"请选择菜单类型"}],module:[{required:!0,message:"请填写菜单模块"}],pid:[{type:"number",required:!0,message:"请选择上级菜单"}]}}},methods:{handleEmpty:function(){this.form={title:"",rule_name:"",rule_id:null,pid:"",menu_type:"",url:"",module:"",menu:"",sort:""}},dialogClose:function(e){this.centerDialogVisible=!1,this.form.rule_name=e.rule_name,this.form.rule_id=e.rule_id},handleNodeClick:function(e){console.log(e),this.treeVal=e.else,this.form.pid=e.id},add:function(e){var t=this;this.$refs.form.validate(function(e){e&&(t.isLoading=!t.isLoading,Object(i.a)(t.form).then(function(e){"error"!==e?(_g.toastMsg("success","添加成功"),setTimeout(function(){t.goback(),t.isLoading=!t.isLoading},1500)):t.isLoading=!t.isLoading}))})},openRule:function(){this.centerDialogVisible=!0,this.$refs.dialog.open()},handleClose:function(){this.centerDialogVisible=!1,this.$refs.dialog.close()}},created:function(){var e=this;Object(i.d)().then(function(t){if("error"!==t){var l=[];_(t.data).forEach(function(e){3!=e.level&&1==e.menu_type&&l.push(e)}),console.log(l),e.options=l}})}},r=(l("t8iv"),l("KHd+")),s=Object(r.a)(o,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("sticky",{attrs:{className:"sub-navbar "+e.postForm.status,stickyTop:84}},[l("div",{ref:"appMainFixed",staticClass:"app-main-btm-fixed"},[l("h1",{staticClass:"page-title-box"},[e._v("\n        菜单管理"),l("em"),l("span",[e._v("/添加列表项")])]),e._v(" "),l("div",[l("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-close"},on:{click:function(t){e.handleEmpty()}}},[e._v("清空表单")]),e._v(" "),l("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"mini",loading:e.isLoading},on:{click:e.add}},[e._v("保存")])],1)])]),e._v(" "),l("div",{staticClass:"app_main_content"},[l("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"top"}},[l("div",{staticClass:"block-box"},[l("h1",{staticClass:"block-header-box"},[l("i"),e._v("\n          基本信息\n        ")]),e._v(" "),l("div",{staticClass:"block-content-box"},[l("el-row",{attrs:{gutter:30}},[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"标题",prop:"title"}},[l("el-input",{attrs:{placeholder:"请输入标题",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"==typeof t?t.trim():t)},expression:"form.title"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"绑定权限标识",prop:"rule_name"}},[l("el-input",{attrs:{clearable:"",placeholder:"请选择绑定权限",disabled:!0},model:{value:e.form.rule_name,callback:function(t){e.$set(e.form,"rule_name","string"==typeof t?t.trim():t)},expression:"form.rule_name"}},[l("el-button",{attrs:{slot:"append"},on:{click:function(t){e.openRule()}},slot:"append"},[e._v("查找")])],1)],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"上级菜单",prop:"pid"}},[l("multi-picker",{attrs:{options:e.options,width:300,defaultProps:e.defaultProps,treeVal:e.treeVal},on:{treeClick:e.handleNodeClick}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"路径"}},[l("el-input",{attrs:{clearable:""},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url","string"==typeof t?t.trim():t)},expression:"form.url"}})],1)],1)],1),e._v(" "),l("el-row",{attrs:{gutter:30}},[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"模块",prop:"module"}},[l("el-input",{attrs:{clearable:""},model:{value:e.form.module,callback:function(t){e.$set(e.form,"module","string"==typeof t?t.trim():t)},expression:"form.module"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"所属菜单"}},[l("el-input",{attrs:{clearable:""},model:{value:e.form.menu,callback:function(t){e.$set(e.form,"menu","string"==typeof t?t.trim():t)},expression:"form.menu"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"排序"}},[l("el-input",{attrs:{clearable:""},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1)],1)],1),e._v(" "),l("el-row",{attrs:{gutter:30}},[l("el-form-item",{attrs:{label:"菜单类型",prop:"menu_type"}},[l("el-radio-group",{model:{value:e.form.menu_type,callback:function(t){e.$set(e.form,"menu_type",t)},expression:"form.menu_type"}},[l("el-radio",{attrs:{label:"1"}},[e._v("普通三级菜单")]),e._v(" "),l("el-radio",{attrs:{label:"2"}},[e._v("单页菜单")]),e._v(" "),l("el-radio",{attrs:{label:"3"}},[e._v("外链")])],1)],1)],1)],1)])])],1),e._v(" "),l("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],ref:"dialog",attrs:{width:"800px",visible:e.centerDialogVisible,"before-close":e.handleClose,title:"绑定权限标识"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[e.centerDialogVisible?l("ruleList",{ref:"ruleList",on:{closeRule:e.dialogClose}}):e._e()],1)],1)},[],!1,null,"f686152c",null);s.options.__file="add.vue";t.default=s.exports},"9F6i":function(e,t,l){"use strict";var n=l("kFDl"),a=l("jr1U"),i=l.n(a),o=l("rfXi"),r=l.n(o),s=l("Kw5r");function u(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=[];return r()(e).forEach(function(e){void 0===e._expanded&&s.default.set(e,"_expanded",t);var i=1;if(void 0!==n&&null!==n&&(i=n+1),s.default.set(e,"_level",i),l&&s.default.set(e,"parent",l),a.push(e),e.children&&e.children.length>0){var o=u(e.children,t,e,i);a=a.concat(o)}}),a}var c={name:"treeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},created:function(){},computed:{formatData:function(){var e=void 0;e=Array.isArray(this.data)?this.data:[this.data];var t=this.evalFunc||u,l=this.evalArgs?i()([e,this.expandAll],this.evalArgs):[e,this.expandAll];return t.apply(null,l)}},methods:{showRow:function(e){var t=!e.row.parent||e.row.parent._expanded&&e.row.parent._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},handleSelectionChange:function(e){this.$emit("selectVal",e)},toggleExpanded:function(e){var t=this.formatData[e];t._expanded=!t._expanded},iconShow:function(e,t){return 0===e&&t.children&&t.children.length>0}}},d=(l("Vfc6"),l("rtKK"),l("KHd+")),f=Object(d.a)(c,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-table",e._b({attrs:{data:e.formatData,"row-style":e.showRow},on:{"selection-change":e.handleSelectionChange}},"el-table",e.$attrs,!1),[0===e.columns.length?l("el-table-column",{attrs:{label:"显示名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row._level,function(e){return l("span",{key:e,staticClass:"ms-tree-space"})}),e._v(" "),e.iconShow(0,t.row)?l("span",{staticClass:"tree-ctrl",on:{click:function(l){e.toggleExpanded(t.$index)}}},[t.row._expanded?l("i",{staticClass:"el-icon-caret-bottom"}):l("i",{staticClass:"el-icon-caret-right"})]):e._e(),e._v("\n      "+e._s(t.row.title)+"\n    ")]}}])}):e._l(e.columns,function(t,n){return l("el-table-column",{key:t.value,attrs:{label:t.text,width:t.width},scopedSlots:e._u([{key:"default",fn:function(a){return[e._l(a.row._level,function(t){return 0===n?l("span",{key:t,staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.iconShow(n,a.row)?l("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(a.$index)}}},[a.row._expanded?l("i",{staticClass:"el-icon-minus"}):l("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n      "+e._s(a.row[t.value])+"\n    ")]}}])})}),e._v(" "),e._t("default")],2)},[],!1,null,"4e78801c",null);function p(e,t,l,n,a){var i=[],o=[];return r()(e).forEach(function(e){void 0===e._expanded&&s.default.set(e,"_expanded",t);var r=1;if(void 0!==n&&null!==n&&(r=n+1),s.default.set(e,"_level",r),l?(s.default.set(e,"parent",l),i[r]||(i[r]=0),s.default.set(e,"_marginLeft",i[r]+l._marginLeft),s.default.set(e,"_width",e[a]/l[a]*l._width),i[r]+=e._width):(i[e.id]=[],i[e.id][r]=0,s.default.set(e,"_marginLeft",0),s.default.set(e,"_width",1)),o.push(e),e.children&&e.children.length>0){var u=p(e.children,t,e,r,a);o=o.concat(u)}}),o}f.options.__file="index.vue";var m={props:["flag"],components:{treeTable:f.exports},data:function(){return{func:p,args:[null,null,"timeLine"],keyword:"",tableData:[],newFlag:!1,expandAll:!1,loading:!0,tableHeight:null,multipleSelection:[]}},methods:{getSelectVal:function(e){this.multipleSelection=e},selectRule:function(e){var t={rule_name:e.title,rule_id:e.id};this.$emit("closeRule",t)},getRules:function(){var e=this;Object(n.e)().then(function(t){e.tableDataShow=_(t.data).forEach(function(e){e.showInput=!1}),e.tableData=e.tableDataShow,e.loading=!e.loading})}},created:function(){var e=store.state.rules;e&&e.length?(this.tableDataShow=_(e).forEach(function(e){e.showInput=!1}),this.tableData=this.tableDataShow):(console.log("aaa"),this.getRules()),console.log(e)}},h=(l("1Tpe"),Object(d.a)(m,function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("dialog-scroll",{attrs:{height:"500px"}},[l("div",{staticStyle:{"padding-bottom":"20px"}},[l("tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,evalFunc:e.func,evalArgs:e.args,"element-loading-text":"数据加载中",expandAll:e.expandAll,"max-height":e.tableHeight,border:""},on:{selectVal:e.getSelectVal}},[l("el-table-column",{attrs:{prop:"title",label:"规则名称"}}),e._v(" "),l("el-table-column",{attrs:{prop:"name",label:"规则标识",width:"180"}}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("div",[l("el-button",{attrs:{size:"small"},on:{click:function(l){e.selectRule(t.row)}}},[e._v("选择")])],1)]}}])})],1)],1)])},[],!1,null,"5c8d9a5a",null));h.options.__file="rule.vue";t.a=h.exports},"SdK+":function(e,t,l){},TK5H:function(e,t,l){},Vfc6:function(e,t,l){"use strict";var n=l("bXlL");l.n(n).a},bXlL:function(e,t,l){},eywq:function(e,t,l){},jr1U:function(e,t,l){e.exports={default:l("wObO"),__esModule:!0}},kFDl:function(e,t,l){"use strict";l.d(t,"d",function(){return a}),l.d(t,"c",function(){return i}),l.d(t,"b",function(){return o}),l.d(t,"a",function(){return r}),l.d(t,"f",function(){return s}),l.d(t,"e",function(){return u});var n=l("t3Un");function a(){return n.a.get("admin/menus")}function i(e){return n.a.delete("admin/menus/",e)}function o(e){return n.a.get("admin/menus/"+e)}function r(e){return n.a.post("admin/menus",e)}function s(e,t){return n.a.put("admin/menus/",e,t)}function u(){return n.a.get("admin/rules")}},rtKK:function(e,t,l){"use strict";var n=l("SdK+");l.n(n).a},t8iv:function(e,t,l){"use strict";var n=l("eywq");l.n(n).a},wObO:function(e,t){e.exports=function(){return Function.call.apply(Array.prototype.concat,arguments)}}}]);