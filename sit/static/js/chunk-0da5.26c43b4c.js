(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0da5","j1/f"],{KfsP:function(e,t,i){"use strict";i.r(t);var n=i("xEMq"),a=i("j1/f"),o=i("pCtG"),s={name:"insideMessageTemplateList",components:{tempEdit:a.default},mixins:[o.a],data:function(){return{tableData:[],loading:!0,tableHeight:null,loadingEditIndex:null,centerDialogVisible:!1}},created:function(){this.init()},methods:{init:function(){var e=this;this.loading=!0,Object(n.j)().then(function(t){"error"!==t&&(e.tableData=t.data.map(function(e){return e.isEditLoading=!1,e.isDeleteLoading=!1,e}),e.loading=!e.loading)})},dialogClose:function(){this.tableData[this.loadingEditIndex].isEditLoading=!1,this.refresh(),this.centerDialogVisible=!1},handleClose:function(){this.tableData[this.loadingEditIndex].isEditLoading=!1,this.centerDialogVisible=!1,this.$refs.dialog.close()},handleEdit:function(e){this.tableData[e.$index].isEditLoading=!0,this.editId=e.row.id,this.centerDialogVisible=!0,this.loadingEditIndex=e.$index,this.$refs.dialog.open()},handleDelete:function(e){var t=this;this.tableData[e.$index].isDeleteLoading=!0,this.$confirm("确定删除该模板吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.g)(e.row.id).then(function(e){"error"!==e&&(_g.toastMsg("success","删除成功"),setTimeout(function(){t.refresh()}))})}).catch(function(){t.tableData[e.$index].isDeleteLoading=!1})}},computed:{indexShow:function(){return _g.getHasRule("insidemessagetemplate-index")},addShow:function(){return _g.getHasRule("insidemessagetemplate-save")},readShow:function(){return _g.getHasRule("insidemessagetemplate-read")},deleteShow:function(){return _g.getHasRule("insidemessagetemplate-delete")}}},l=(i("tV+8"),i("KHd+")),r=Object(l.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"mainContainer",staticClass:"app_main_container"},[i("div",{ref:"topAdd",staticClass:"top_add_container"},[i("router-link",{attrs:{to:"add"}},[e.addShow?i("el-button",{staticClass:"add_btn",attrs:{type:"primary",size:"small",icon:"el-icon-plus"}},[e._v("添加模板")]):e._e()],1)],1),e._v(" "),e.indexShow?i("div",{staticClass:"page_table_box"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","max-height":e.tableHeight}},[i("el-table-column",{attrs:{label:"模板名称",prop:"template_name"}}),e._v(" "),i("el-table-column",{attrs:{label:"模板内容",prop:"template_content"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"172"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[i("span",[e.readShow?i("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",loading:t.row.isEditLoading},on:{click:function(i){e.handleEdit(t)}}},[e._v("编辑")]):e._e()],1),e._v(" "),i("span",[e.deleteShow?i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",loading:t.row.isDeleteLoading},on:{click:function(i){e.handleDelete(t)}}},[e._v("删除")]):e._e()],1)])]}}])})],1)],1):e._e(),e._v(" "),i("el-dialog",{ref:"dialog",staticClass:"dialog-slider",attrs:{top:"0",width:"400px",visible:e.centerDialogVisible,"before-close":e.handleClose,title:"险种编辑"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[e.centerDialogVisible?i("temp-edit",{attrs:{editId:e.editId},on:{close:e.dialogClose}}):e._e()],1),e._v(" "),i("div",{ref:"btmGroup"})],1)},[],!1,null,null,null);r.options.__file="list.vue";t.default=r.exports},"j1/f":function(e,t,i){"use strict";i.r(t);var n=i("xEMq"),a={props:["editId"],data:function(){return{form:{template_name:"",template_content:""},isLoading:!1,rules:{template_name:[{required:!0,message:"请输入模板的名称",trigger:"blur"}],template_content:[{required:!0,message:"请输入模板的内容",trigger:"blur"}]}}},created:function(){var e=this;Object(n.h)(this.editId).then(function(t){"error"!==t&&(e.form=t.data)})},methods:{handleSubmit:function(){var e=this;this.isLoading=!0,this.$refs.form.validate(function(t){t&&Object(n.i)(e.editId,e.form).then(function(t){"error"!==t?(_g.toastMsg("success","保存成功"),setTimeout(function(){e.isLoading=!e.isLoading,e.$emit("close")},1500)):e.isLoading=!e.isLoading})})}},computed:{editShow:function(){return _g.getHasRule("insidemessagetemplate-update")}}},o=i("KHd+"),s=Object(o.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("dialog-scroll",[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px","label-position":"top"}},[i("el-form-item",{attrs:{label:"模板名称",prop:"template_name"}},[i("el-input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.form.template_name,callback:function(t){e.$set(e.form,"template_name","string"==typeof t?t.trim():t)},expression:"form.template_name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"模板内容",prop:"template_content"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入模板内容"},model:{value:e.form.template_content,callback:function(t){e.$set(e.form,"template_content","string"==typeof t?t.trim():t)},expression:"form.template_content"}})],1),e._v(" "),i("el-form-item",[e.editShow?i("el-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:e.handleSubmit}},[e._v("立即保存")]):e._e()],1)],1)],1)},[],!1,null,null,null);s.options.__file="edit.vue";t.default=s.exports},pCtG:function(e,t,i){"use strict";var n=i("7Qib");t.a={mounted:function(){var e=this;this.valHandle(),this.__resizeMainHanlder=Object(n.a)(function(){e.valHandle(0,0)},100),window.addEventListener("resize",this.__resizeMainHanlder)},methods:{valHandle:function(e,t){var i=this.$refs.mainContainer.offsetHeight-40-((this.$refs.topAdd?this.$refs.topAdd.offsetHeight:0)+(this.$refs.btmGroup?this.$refs.btmGroup.offsetHeight:20));this.tableHeight=i}},beforeDestroy:function(){window.removeEventListener("resize",this.__resizeMainHanlder)}}},sPj4:function(e,t,i){},"tV+8":function(e,t,i){"use strict";var n=i("sPj4");i.n(n).a}}]);