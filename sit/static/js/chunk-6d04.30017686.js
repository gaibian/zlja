(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6d04"],{"4d0P":function(e,t,s){"use strict";s.r(t);var i=s("thsz"),o={data:function(){return{postForm:{status:"draft"},isLoading:!1,loading:!0,form:{title:"",pid:"",remark:"",rules:"",child_rules:""},defaultProps:{children:"child",label:"title"},options:[{pid:0,id:0,title:"无"}],nodes:[],selectedNodes:[],rules:{title:[{required:!0,message:"请输入用户组名称",trigger:"blur"}],pid:[{required:!0,message:"请选择父级用户组",trigger:"change"}]}}},methods:{handleEmpty:function(){this.form={title:"",pid:"",remark:"",rules:"",child_rules:""}},add:function(e){var t=this;this.form.rules=this.$refs.tree.getCheckedKeys().concat(this.$refs.tree.getHalfCheckedKeys()).toString(),this.form.child_rules=this.$refs.tree.getCheckedKeys().toString(),console.log(this.form),this.$refs.form.validate(function(e){e&&(t.isLoading=!t.isLoading,Object(i.a)(t.form).then(function(e){_g.toastMsg("success","添加成功"),t.isLoading=!t.isLoading,setTimeout(function(){t.addRefresh("groupsList")},1500)}))})},getRules:function(){var e=this;Object(i.c)().then(function(t){e.nodes=e.nodes.concat(t.data),console.log(e.nodes),e.loading=!1})},getGroups:function(){var e=this;Object(i.f)().then(function(t){e.options=e.options.concat(t.data)})},selectProjectRule:function(e){var t=this;e.check||_(e.child).forEach(function(e){e.check=!1;var s=_(t.selectedNodes).indexOf(e.id);t.selectedNodes.splice(s,1),_(e.child).forEach(function(e){e.check=!1;var s=_(t.selectedNodes).indexOf(e.id);t.selectedNodes.splice(s,1)})}),this.selectRule(e)},selectModuleRule:function(e,t,s){var i=this;if(t.check||(t.check=!0,this.selectedNodes.push(t.id)),e.check)this.selectedNodes.push(e.id),_(s).forEach(function(e){e.check=!0,i.selectedNodes.push(e.id)});else{var o=_(this.selectedNodes).indexOf(e.id);this.selectedNodes.splice(o,1),_(s).forEach(function(e){var t=_(i.selectedNodes).indexOf(e.id);t>=0&&(e.check=!1,i.selectedNodes.splice(t,1))})}},selectActionRule:function(e,t,s){t.check||(t.check=!0,this.selectedNodes.push(t.id)),s.check||(s.check=!0,this.selectedNodes.push(s.id)),this.selectRule(e)},selectRule:function(e){if(e.check)this.selectedNodes.push(e.id);else{var t=_(this.selectedNodes).indexOf(e.id);this.selectedNodes.splice(t,1)}}},created:function(){this.getRules(),this.getGroups()}},n=(s("TdRz"),s("KHd+")),c=Object(n.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("sticky",{attrs:{className:"sub-navbar "+e.postForm.status,stickyTop:84}},[s("div",{ref:"appMainFixed",staticClass:"app-main-btm-fixed"},[s("h1",{staticClass:"page-title-box"},[e._v("\n        用户组"),s("em"),s("span",[e._v("/添加列表项")])]),e._v(" "),s("div",[s("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-close"},on:{click:function(t){e.handleEmpty()}}},[e._v("清空表单")]),e._v(" "),s("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"mini",loading:e.isLoading},on:{click:e.add}},[e._v("保存")])],1)])]),e._v(" "),s("div",{staticClass:"app_main_content"},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px","label-position":"top"}},[s("div",{staticClass:"block-box"},[s("h1",{staticClass:"block-header-box"},[s("i"),e._v("\n          基本信息\n        ")]),e._v(" "),s("div",{staticClass:"block-content-box"},[s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"用户组名",prop:"title"}},[s("el-input",{attrs:{clearable:"",placeholder:"请输入用户组名称"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"==typeof t?t.trim():t)},expression:"form.title"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"父级用户组",prop:"pid"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择父级用户组"},model:{value:e.form.pid,callback:function(t){e.$set(e.form,"pid",t)},expression:"form.pid"}},e._l(e.options,function(e,t){return s("el-option",{key:t,attrs:{label:e.title,value:e.id}})}))],1)],1)],1),e._v(" "),s("el-row",[s("el-form-item",{attrs:{label:"备注信息"}},[s("el-input",{attrs:{type:"textarea",clearable:"",placeholder:"请输入备注信息"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)]),e._v(" "),s("div",{staticClass:"block-box"},[s("h1",{staticClass:"block-header-box"},[s("i"),e._v("\n          权限信息\n        ")]),e._v(" "),s("div",{staticClass:"block-content-box"},[s("el-form-item",{attrs:{label:"权限分配"}},[s("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tree",attrs:{data:e.nodes,"show-checkbox":"","node-key":"id","element-loading-text":"拼命加载中","default-expand-all":"",props:e.defaultProps}})],1)],1)])])],1)],1)},[],!1,null,"e5a8c28a",null);c.options.__file="add.vue";t.default=c.exports},TdRz:function(e,t,s){"use strict";var i=s("aOfi");s.n(i).a},aOfi:function(e,t,s){},thsz:function(e,t,s){"use strict";s.d(t,"f",function(){return o}),s.d(t,"e",function(){return n}),s.d(t,"d",function(){return c}),s.d(t,"c",function(){return l}),s.d(t,"b",function(){return r}),s.d(t,"a",function(){return a});var i=s("t3Un");function o(){return i.a.get("admin/groups")}function n(e){return i.a.delete("admin/groups/",e)}function c(e){return i.a.get("admin/groups/"+e)}function l(){return i.a.get("admin/rules?type=tree")}function r(e,t){return i.a.put("admin/groups/",e,t)}function a(e){return i.a.post("admin/groups",e)}}}]);